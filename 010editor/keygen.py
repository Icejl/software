
import random

table  = [ 969622712,  594890599,  1593930257,  1052452058,  890701766,  1677293387,  394424968,  266815521,  1532978959,  1211194088,  2019260265,  729421127,  953225874,  1117854514,  892543556,  2000911200,  514538256,  1400963072,  486675118,  1862498216,  1136668818,  758909582,  1653935295,  821063674,  888606944,  687085563,  890056597,  1513495898,  365692427,  184357836,  677395407,  863045227,  818746596,  391985767,  1842768403,  758385145,  1478392706,  1985112985,  1552765320,  746944881,  368385984,  1758203153,  1240817244,  660489060,  756944316,  1290697955,  844453952,  288239112,  1769473626,  1922176006,  826636519,  391520695,  1081548223,  1069693142,  1244729994,  766313326,  1101031894,  624951698,  14501479,  1794907983,  1460682958,  1660839647,  1104890686,  897721119,  1442187162,  480708164,  454443986,  1064446153,  1595150448,  1041527979,  1145775470,  1399869657,  255985995,  802693350,  2005610078,  1897360642,  2146073193,  1538606632,  431647857,  964049561,  395138253,  19164808,  856904574,  730737943,  708645054,  1506870658,  933323739,  819349658,  1780571206,  236747382,  533160167,  2042104933,  670325172,  2040165158,  1354372994,  705785180,  1669754395,  1066536508,  1426207888,  1437950089,  741941201,  796931522,  1694313338,  1290302874,  1367672048,  2039808424,  1062939821,  954597728,  1668694488,  859122242,  1369582617,  140269649,  53024683,  729221831,  816609203,  736893191,  55706320,  262747091,  1629838835,  581764799,  1488480625,  1607077349,  1879925846,  1453945819,  1521965565,  856558562,  1530662365,  1230847072,  1404918182,  1281256849,  1238970765,  272453753,  1640907491,  2127893021,  350314733,  556617458,  654390256,  1648581270,  531062411,  1862873022,  1241517385,  1471028336,  5121143,  1444839026,  1183580211,  1573659650,  2018540230,  1487873223,  234237236,  898254600,  1023090193,  728843548,  2007454357,  1451820833,  267351539,  302982385,  26807015,  865879122,  664886158,  195503981,  1625037691,  1330347906,  1742434311,  1330272217,  1645368040,  542321916,  1782121222,  411042851,  435386250,  1176704752,  1454246199,  1136813916,  1707755005,  224415730,  201138891,  989750331,  1006010278,  1147286905,  406860280,  840388503,  1282017578,  1605698145,  23396724,  862145265,  1898780916,  1855549801,  1571519230,  2083204840,  1859876276,  1602449334,  1009413590,  690816450,  86131931,  345661263,  1565025600,  857544170,  1329948960,  1211787679,  994381573,  991984748,  1956475134,  1098146294,  1655714289,  659576699,  689116467,  1485584392,  451884118,  255590636,  2108114754,  1266252396,  1589326471,  2019907768,  15552498,  1651075358,  614606175,  1656823678,  797605325,  1681594366,  2005080248,  624648446,  884695971,  1526931791,  1595240948,  439447199,  2060396292,  680093752,  409028215,  469068267,  195583689,  1791650630,  507724330,  1364025102,  1094582668,  813049577,  32316922,  1240756058,  1176200235,  2104494066,  325396055,  1796606917,  1709197385,  525495836,  1510101430,  735526761,  767523533,  1374043776,  1559389967,  567085571,  1560216161,  867042846,  1001796703,  1568754293,  628841972,  173812827,  379868455,  384973125,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0]


def sub_14036D520(a1):
    v1 = ((a1 ^ 0x7892) + 19760) ^ 0x3421
    v1 &= 0xffff
    
    s.add( (v1 % 0xb) != 0)
   
    return v1//0xB

def sub_14036D600(username, flag, a3, a4):
    a3 &= 0xff
    a4 &= 0xff
    j = 17 * a3
    k = 15 * a4
    m1 = 0
    m2 = 0
    result = 0
    for i in range(len(username)):
        
        j &= 0xff
        k &= 0xff
        m1 &= 0xff
        m2 &= 0xff
            
        idx = ord(username[i].upper())
        v1 = table[j]
        v2 = result + table[idx]
        v3 = table[k]
        
        if flag:
            v4 = table[(idx+13) & 0xff]
            v5 = (idx+47) & 0xff
            v6 = m1
        else:
            v4 = table[(idx+63) & 0xff]
            v5 = (idx+23) & 0xff
            v6 = m2
        
        j += 9
        k += 13
        m1 += 19
        m2 += 7
        
        
        result = v3 + v1 + table[v6] + table[v5] * (v2 ^ v4)
    return result & 0xffffffff



def gen1(username):

    pwd = [0] * 10
    v22 = 0x8000 # 代码有效时间 * 86400
    a48 = 100  # 注册码可用次数？
    v25 = sub_14036D600(username, 1, v22, a48);
    
    pwd[3] = 0x9c  # 0xac 注册方式 固定
    pwd[4] = v25 & 0xff
    pwd[5] = (v25 >> 8) & 0xff
    pwd[6] = (v25 >> 16) & 0xff
    pwd[7] = (v25 >> 24) & 0xff
    
    # t = (pwd[5]^pwd[2]) + ((pwd[7]^pwd[1]) << 8)
    t = (((a48 * 0xb) ^ 0x3421) + 0x10000 - 19760) ^ 0x7892
    
    pwd[2] = (t & 0xff) ^ pwd[5]
    pwd[1] = ((t>>8) & 0xff) ^ pwd[7]
    
    pwd[0] = ((v22 ^ 0xa7) + 0x100 - 61 ) ^ 0x18 ^ pwd[6]
    pwd[0] &= 0xff
    
    pwd[8] = random.randint(1,0xff)
    pwd[9] = random.randint(1,0xff)
    
    key = ''
    for i in range(8):
        key += "%02x" %pwd[i]
        if i in [1,3,5]:
            key += '-'
   
    print(key)
   
    
        
def gen2(username):

    pwd = [0] * 10
    v22 = 0x8000 # 代码有效时间 * 86400
    a48 = 100  # 注册码可用次数？
    v25 = sub_14036D600(username, 1, v22, a48);
    
    pwd[3] = 0xac  # 0xac 注册方式 固定
    pwd[4] = v25 & 0xff
    pwd[5] = (v25 >> 8) & 0xff
    pwd[6] = (v25 >> 16) & 0xff
    pwd[7] = (v25 >> 24) & 0xff

    # t = (pwd[6] ^ pwd[0]) + ( (pwd[5] ^ pwd[9]) << 16 ) + ( (pwd[8] ^ pwd[4]) << 8 )
    t = (((v22 * 0x11) ^ 0xFFE53167) + 180597 ) ^ 0x22C078 ^ 0x5B8C27
    
    pwd[0] = (t & 0xff) ^ pwd[6]
    pwd[9] = ( (t >> 16) & 0xff ) ^ pwd[5]
    pwd[8] = ( (t >> 8) & 0xff ) ^ pwd[4]
    
    # t = (pwd[5]^pwd[2]) + ((pwd[7]^pwd[1]) << 8)
    t = (((a48 * 0xb) ^ 0x3421) + 0x10000 - 19760) ^ 0x7892

    pwd[2] = (t & 0xff) ^ pwd[5]
    pwd[1] = ((t>>8) & 0xff) ^ pwd[7]

    key = ''
    for i in range(10):
        key += "%02x" %pwd[i]
        if i in [1,3,5,7]:
            key += '-'
   
    print(key)
        
#gen1("test.com")
gen2("test.com")